<!-- =============================================================================
     TEMPLATE: FORMULARIO PARA CREAR NUEVA TAREA
     =============================================================================
     Esta página muestra un formulario para crear una nueva tarea
     
     CONCEPTOS CLAVE:
     - Formulario HTML: Permite al usuario enviar datos al servidor
     - method="post": Los datos se envían de forma segura (no visibles en la URL)
     - action="/crear": La URL donde se envían los datos del formulario
     - name="title": Identifica el campo en el servidor (request.form["title"])
     - Bootstrap: Clases CSS para estilizar el formulario
     ============================================================================= -->
<!-- Heredamos la estructura del template layout.html -->
{% extends "layout.html" %}
<!-- Definimos el título del documento de esta página -->
{% block title %}Nueva Tarea{% endblock %}
<!-- Definimos el contenido específico de esta página -->
{% block content %}
<!-- Título de la página -->
<h1>Nueva Tarea</h1>
<!-- FORMULARIO HTML -->
<!-- action="/crear" = URL donde se envían los datos -->
<!-- method="post" = Método HTTP para enviar datos de forma segura -->
<form action="/editar/{{ tarea.id }}" method="post">
  <!-- ETIQUETA DEL CAMPO -->
  <!-- for="nombre" = Asocia la etiqueta con el campo de entrada -->
  <!-- form-label = Clase de Bootstrap para estilizar etiquetas -->
  <label class="form-label" for="nombre">Título de la tarea</label>
  <!-- CAMPO DE ENTRADA -->
  <!-- name="title" = Nombre del campo (se usa en request.form["title"]) -->
  <!-- class="form-control" = Estilo de Bootstrap para campos de entrada -->
  <!-- type="text" = Tipo de entrada (texto) -->
  <!-- id="nombre" = Identificador único del campo (se asocia con for="nombre") -->
  <input name="title" class="form-control" value="{{ tarea.nombre }}" type="text" id="nombre">
  <!-- Selección de categoría -->
  <!-- Soporta elegir una categoría existente o crear una nueva escribiendo el nombre -->
  <br>
  <label class="form-label" for="categoria">Categoría</label>
  <select
    id="categoria"
    name="categoria"
    class="form-select"
    placeholder="Selecciona o crea una categoría"
  >
    <option value="" disabled>Selecciona una categoría</option>
    {% if categorias %}
      {% for cat in categorias %}
    <option value="{{ cat.id }}" {% if cat.id == tarea.categoria_id %}selected{% endif %}>{{ cat.nombre }}</option>
    {% endfor %}
    {% endif %}
  </select>
  <!-- Espaciado -->
  <br>
  <!-- BOTÓN DE ENVÍO -->
  <!-- type="submit" = Botón que envía el formulario -->
  <!-- class="btn btn-primary" = Estilo de botón azul de Bootstrap -->
  <button type="submit" class="btn btn-primary">Guardar</button>
</form>
<!-- Tom Select: permite crear opciones nuevas al vuelo sin jQuery -->
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
<script>
  /* document.addEventListener('DOMContentLoaded', function() {
    var el = document.getElementById('categoria');
    if (el) {
      new TomSelect(el, {
        create: function(input) {
          // Devuelve un objeto con value/label para crear una nueva categoría
          return { value: input, text: input };
        },
        createOnBlur: true,
        persist: false,
        allowEmptyOption: true,
        placeholder: 'Selecciona o crea una categoría'
      });
    }
  }); */
</script>
{% endblock %}